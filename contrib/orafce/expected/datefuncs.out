\set VERBOSITY terse
SET client_encoding = utf8;
set datestyle='ISO,MDY';
set time zone 'PRC';
set compatible_mode to oracle;
select oracle.from_tz('2021-11-08 09:12:39','+16:00') from dual;
ERROR:  timeszone must be between -16 and 16 
select oracle.from_tz('2021-11-08 09:12:39','-12:00') from dual;
          from_tz           
----------------------------
 2021-11-08 09:12:39 -12:00
(1 row)

select oracle.from_tz('2021-11-08 09:12:39','Asia/Shanghai123123') from dual;
ERROR:  times zone unrecognized
select oracle.from_tz('2021-11-08 09:12:39','Asia/Shanghai') from dual;
              from_tz              
-----------------------------------
 2021-11-08 09:12:39 Asia/Shanghai
(1 row)

select oracle.from_tz('2021-11-08 09:12:39','SAST') from dual;
         from_tz          
--------------------------
 2021-11-08 09:12:39 SAST
(1 row)

select oracle.from_tz('2021-11-08 09:12:39','SAST123') from dual;
ERROR:  times zone unrecognized
select oracle.from_tz(NULL,'SAST') from dual;
 from_tz 
---------
 
(1 row)

select oracle.from_tz('2021-11-08 09:12:31',NULL) from dual;
 from_tz 
---------
 
(1 row)

select oracle.from_tz(NULL,NULL) from dual;
 from_tz 
---------
 
(1 row)

--numtodsinterval function
select oracle.numtodsinterval(2147483647.1232131232,'day') from dual;
ERROR:  interval out of range
select oracle.numtodsinterval(2147483646.1232131232,'day') from dual;
                 numtodsinterval                  
--------------------------------------------------
 @ 2147483646 days 2 hours 57 mins 25.607758 secs
(1 row)

select oracle.numtodsinterval(2147483647.1232131232,'hour') from dual;
             numtodsinterval              
------------------------------------------
 @ 2147483647 hours 7 mins 23.567104 secs
(1 row)

select oracle.numtodsinterval(2147483648.1232131232,'hour') from dual;
             numtodsinterval              
------------------------------------------
 @ 2147483648 hours 7 mins 23.568128 secs
(1 row)

select oracle.numtodsinterval(128849018879.1232131232,'minute') from dual;
             numtodsinterval              
------------------------------------------
 @ 2147483647 hours 59 mins 7.393024 secs
(1 row)

select oracle.numtodsinterval(128849018880.1232131232,'minute') from dual;
         numtodsinterval         
---------------------------------
 @ 2147483648 hours 7.39328 secs
(1 row)

select oracle.numtodsinterval(7730941132799.1232131232,'second') from dual;
              numtodsinterval              
-------------------------------------------
 @ 2147483647 hours 59 mins 59.123456 secs
(1 row)

select oracle.numtodsinterval(7730941132800.1232131232,'second') from dual;
         numtodsinterval         
---------------------------------
 @ 2147483648 hours 0.12288 secs
(1 row)

select oracle.numtodsinterval(NULL,'second') from dual;
 numtodsinterval 
-----------------
 
(1 row)

select oracle.numtodsinterval(7730941132800.1232131232,NULL) from dual;
 numtodsinterval 
-----------------
 
(1 row)

select oracle.numtodsinterval(NULL,NULL) from dual;
 numtodsinterval 
-----------------
 
(1 row)

--numtoyminterval function
select oracle.numtoyminterval(178956970.1232131232,'year') from dual;
                       numtoyminterval                       
-------------------------------------------------------------
 @ 178956970 years 1 mon 14 days 8 hours 33 mins 40.608 secs
(1 row)

select oracle.numtoyminterval(178956971.1232131232,'year') from dual;
ERROR:  interval out of range
select oracle.numtoyminterval(2147483646.1232131232,'month') from dual;
                        numtoyminterval                        
---------------------------------------------------------------
 @ 178956970 years 6 mons 3 days 16 hours 42 mins 48.2688 secs
(1 row)

select oracle.numtoyminterval(2147483647.1232131232,'month') from dual;
ERROR:  interval out of range
select oracle.numtoyminterval(NULL,'month') from dual;
 numtoyminterval 
-----------------
 
(1 row)

select oracle.numtoyminterval(2147483647.1232131232,NULL) from dual;
 numtoyminterval 
-----------------
 
(1 row)

select oracle.numtoyminterval(NULL,NULL) from dual;
 numtoyminterval 
-----------------
 
(1 row)

--sys_extract_utc function
select oracle.sys_extract_utc('2018-03-28 11:30:00.00 +09:00'::timestamptz) from dual;
   sys_extract_utc   
---------------------
 2018-03-28 02:30:00
(1 row)

select oracle.sys_extract_utc(NULL) from dual;
 sys_extract_utc 
-----------------
 
(1 row)

--sessiontimezone and dbtimezone function
select oracle.sessiontimezone() from dual;
 sessiontimezone 
-----------------
 PRC
(1 row)

select oracle.dbtimezone() from dual;
 dbtimezone 
------------
 PRC
(1 row)

--days_between function
select oracle.days_between('2021-11-25 15:33:16'::timestamp,'2019-01-01 00:00:00'::timestamp) from dual;
   days_between   
------------------
 1059.64810185185
(1 row)

select oracle.days_between('2019-09-08 09:09:09'::timestamp,'2019-01-01 00:00:00'::timestamp) from dual;
   days_between   
------------------
 250.381354166667
(1 row)

select oracle.days_between('2021-11-25 09:09:09'::timestamp,'2019-01-01 00:00:00'::timestamp) from dual;
   days_between   
------------------
 1059.38135416667
(1 row)

select oracle.days_between(NULL,'2019-01-01 00:00:00'::timestamp) from dual;
 days_between 
--------------
             
(1 row)

select oracle.days_between('2019-09-08 09:09:09'::timestamp,NULL) from dual;
 days_between 
--------------
             
(1 row)

select oracle.days_between(NULL,NULL) from dual;
 days_between 
--------------
             
(1 row)

--days_between_tmtz function
select oracle.days_between_tmtz('2019-09-08 09:09:09+08'::timestamptz,'2019-05-08 12:34:09+08'::timestamptz) from dual;
 days_between_tmtz 
-------------------
  122.857638888889
(1 row)

select oracle.days_between_tmtz('2019-09-08 09:09:09+08'::timestamptz,'2019-05-08 12:34:09+09'::timestamptz) from dual;
 days_between_tmtz 
-------------------
  122.899305555556
(1 row)

select oracle.days_between_tmtz('2019-09-08 09:09:09-08'::timestamptz,'2019-05-08 12:34:09+09'::timestamptz) from dual;
 days_between_tmtz 
-------------------
  123.565972222222
(1 row)

select oracle.days_between_tmtz(NULL,'2019-05-08 12:34:09+08'::timestamptz) from dual;
 days_between_tmtz 
-------------------
                  
(1 row)

select oracle.days_between_tmtz('2019-09-08 09:09:09+08'::timestamptz,NULL) from dual;
 days_between_tmtz 
-------------------
                  
(1 row)

select oracle.days_between_tmtz(NULL,NULL) from dual;
 days_between_tmtz 
-------------------
                  
(1 row)

--add_days_to_timestamp function
select oracle.add_days_to_timestamp('1009-09-15 09:00:00'::timestamp, '3267.123'::numeric) from dual;
 add_days_to_timestamp 
-----------------------
 1018-08-26 11:57:07.2
(1 row)

select oracle.add_days_to_timestamp(NULL, '3267.123'::numeric) from dual;
 add_days_to_timestamp 
-----------------------
 
(1 row)

select oracle.add_days_to_timestamp('1009-09-15 09:00:00'::timestamp, NULL) from dual;
 add_days_to_timestamp 
-----------------------
 
(1 row)

select oracle.add_days_to_timestamp(NULl, NULL) from dual;
 add_days_to_timestamp 
-----------------------
 
(1 row)

--subtract function
select oracle.subtract('2019-11-25 16:51:20'::timestamp,'3267.123'::numeric) from dual;
         subtract         
--------------------------
 2010-12-15 13:54:12.8+08
(1 row)

select oracle.subtract('2019-11-25 16:51:20'::timestamp, '2018-11-25 16:51:12'::timestamp) from dual;
  subtract  
------------
 365.000093
(1 row)

select oracle.subtract(NULL,'3267.123'::numeric) from dual;
 subtract 
----------
 
(1 row)

select oracle.subtract('2019-11-25 16:51:20'::timestamp,NULL) from dual;
 subtract 
----------
         
(1 row)

select oracle.subtract(NULL,NULL) from dual;
ERROR:  function oracle.subtract(unknown, unknown) is not unique at character 8
--new_time function
select oracle.new_time(timestamp '2020-12-12 17:45:18', 'AST', 'ADT') from dual;
      new_time       
---------------------
 2020-12-12 18:45:18
(1 row)

select oracle.new_time(timestamp '2020-12-12 17:45:18', 'BST', 'BDT') from dual;
      new_time       
---------------------
 2020-12-12 18:45:18
(1 row)

select oracle.new_time(timestamp '2020-12-12 17:45:18', 'CST', 'CDT') from dual;
      new_time       
---------------------
 2020-12-12 18:45:18
(1 row)

select oracle.new_time(timestamp '2020-12-12 17:45:18', 'EST', 'EDT') from dual;
      new_time       
---------------------
 2020-12-12 18:45:18
(1 row)

select oracle.new_time(timestamp '2020-12-12 17:45:18', 'HST', 'HDT') from dual;
      new_time       
---------------------
 2020-12-12 18:45:18
(1 row)

select oracle.new_time(timestamp '2020-12-12 17:45:18', 'MST', 'MDT') from dual;
      new_time       
---------------------
 2020-12-12 18:45:18
(1 row)

select oracle.new_time(timestamp '2020-12-12 17:45:18', 'PST', 'PDT') from dual;
      new_time       
---------------------
 2020-12-12 18:45:18
(1 row)

select oracle.new_time(timestamp '2020-12-12 17:45:18', 'YST', 'YDT') from dual;
      new_time       
---------------------
 2020-12-12 18:45:18
(1 row)

select oracle.new_time(timestamp '2020-12-12 17:45:18', 'GMT', 'EDT') from dual;
      new_time       
---------------------
 2020-12-12 13:45:18
(1 row)

select oracle.new_time(timestamp '2020-12-12 17:45:18', 'NST', 'GMT') from dual;
      new_time       
---------------------
 2020-12-12 21:15:18
(1 row)

select oracle.new_time('2020-10-12 17:42:58 +08'::timestamptz, 'AST', 'ADT') from dual;
      new_time       
---------------------
 2020-10-12 18:42:58
(1 row)

select oracle.new_time('2020-11-12 17:42:58 +08'::timestamptz, 'BST', 'BDT') from dual;
      new_time       
---------------------
 2020-11-12 18:42:58
(1 row)

select oracle.new_time('2020-12-12 13:45:58 +08'::timestamptz, 'CST', 'CDT') from dual;
      new_time       
---------------------
 2020-12-12 14:45:58
(1 row)

select oracle.new_time('2020-10-12 13:45:18 +08'::timestamptz, 'EST', 'EDT') from dual;
      new_time       
---------------------
 2020-10-12 14:45:18
(1 row)

select oracle.new_time('2020-11-12 17:49:18 +08'::timestamptz, 'HST', 'HDT') from dual;
      new_time       
---------------------
 2020-11-12 18:49:18
(1 row)

select oracle.new_time('2020-12-12 17:49:28 +08'::timestamptz, 'MST', 'MDT') from dual;
      new_time       
---------------------
 2020-12-12 18:49:28
(1 row)

select oracle.new_time('2020-10-12 17:45:28 +08'::timestamptz, 'PST', 'PDT') from dual;
      new_time       
---------------------
 2020-10-12 18:45:28
(1 row)

select oracle.new_time('2020-10-12 16:45:18 +08'::timestamptz, 'YST', 'YDT') from dual;
      new_time       
---------------------
 2020-10-12 17:45:18
(1 row)

select oracle.new_time('2020-11-12 16:41:28 +08'::timestamptz, 'GMT', 'EDT') from dual;
      new_time       
---------------------
 2020-11-12 12:41:28
(1 row)

select oracle.new_time('2020-12-12 17:41:18 +08'::timestamptz, 'NST', 'GMT') from dual;
      new_time       
---------------------
 2020-12-12 21:11:18
(1 row)

set compatible_mode to oracle ;
--add_months function
select oracle.add_months(oracle.date '2020-02-15',7) from dual;
     add_months      
---------------------
 2020-09-15 00:00:00
(1 row)

select oracle.add_months(oracle.date '2018-12-15',14) from dual;
     add_months      
---------------------
 2020-02-15 00:00:00
(1 row)

select oracle.add_months(oracle.date '2019-12-15',12) from dual;
     add_months      
---------------------
 2020-12-15 00:00:00
(1 row)

select oracle.add_months(oracle.date '0019-12-15',40) from dual;
     add_months      
---------------------
 0023-04-15 00:00:00
(1 row)

select oracle.add_months(timestamp '2020-02-15 12:12:09',7) from dual;
     add_months      
---------------------
 2020-09-15 12:12:09
(1 row)

select oracle.add_months(timestamp '2018-12-15 19:12:09',14) from dual;
     add_months      
---------------------
 2020-02-15 19:12:09
(1 row)

select oracle.add_months(timestamp '2018-12-15 19:12:09',12) from dual;
     add_months      
---------------------
 2019-12-15 19:12:09
(1 row)

select oracle.add_months(timestamp '2018-12-15 19:12:09',40) from dual;
     add_months      
---------------------
 2022-04-15 19:12:09
(1 row)

select oracle.add_months(timestamptz'2020-02-15 12:12:09 +08',7) from dual;
     add_months      
---------------------
 2020-09-15 12:12:09
(1 row)

select oracle.add_months(timestamptz'2018-12-15 12:12:09 +08',24) from dual;
     add_months      
---------------------
 2020-12-15 12:12:09
(1 row)

select oracle.add_months(timestamptz'2018-12-15 12:12:09 +08',100) from dual;
     add_months      
---------------------
 2027-04-15 12:12:09
(1 row)

select oracle.add_months(timestamptz'2018-12-15 12:12:09 +08',120) from dual;
     add_months      
---------------------
 2028-12-15 12:12:09
(1 row)

select oracle.add_months(oracle.date '-2020-02-15',7) from dual;
      add_months      
----------------------
 -2020-09-15 00:00:00
(1 row)

select oracle.add_months(oracle.date '-2018-12-15',14) from dual;
      add_months      
----------------------
 -2016-02-15 00:00:00
(1 row)

select oracle.add_months(oracle.date '-2019-12-15',12) from dual;
      add_months      
----------------------
 -2018-12-15 00:00:00
(1 row)

select oracle.add_months(oracle.date '-0019-12-15',40) from dual;
      add_months      
----------------------
 -0015-04-15 00:00:00
(1 row)

select oracle.add_months(oracle.date '-0002-12-15',40) from dual;
     add_months      
---------------------
 0003-04-15 00:00:00
(1 row)

select oracle.add_months(oracle.date '0002-12-15',-40) from dual;
      add_months      
----------------------
 -0002-08-15 00:00:00
(1 row)

select oracle.add_months(oracle.date '-0002-12-15 12:14:15',40) from dual;
     add_months      
---------------------
 0003-04-15 12:14:15
(1 row)

select oracle.add_months(oracle.date '-0002-12-15 12:14:15',12) from dual;
      add_months      
----------------------
 -0001-12-15 12:14:15
(1 row)

select oracle.add_months(oracle.date '-0002-12-15 12:14:15',13) from dual;
     add_months      
---------------------
 0001-01-15 12:14:15
(1 row)

select oracle.add_months(oracle.date '0002-12-15 10:02:09',-40) from dual;
      add_months      
----------------------
 -0002-08-15 10:02:09
(1 row)

select oracle.add_months(oracle.date '0002-12-15 10:02:09',-23) from dual;
     add_months      
---------------------
 0001-01-15 10:02:09
(1 row)

select oracle.add_months(oracle.date '0002-12-15 10:02:09',-24) from dual;
      add_months      
----------------------
 -0001-12-15 10:02:09
(1 row)

--months_between function
select oracle.months_between(oracle.date '2020-03-15', oracle.date '2020-02-20') from dual;
  months_between   
-------------------
 0.838709677419355
(1 row)

select oracle.months_between(oracle.date '2020-02-10', oracle.date '2020-05-20') from dual;
  months_between   
-------------------
 -3.32258064516129
(1 row)

select oracle.months_between(oracle.date '2021-11-10', oracle.date '2020-05-20') from dual;
  months_between  
------------------
 17.6774193548387
(1 row)

select oracle.months_between(oracle.date '2021-11-10', oracle.date '2008-05-20') from dual;
  months_between  
------------------
 161.677419354839
(1 row)

select oracle.months_between(timestamp '2021-11-10 20:20:20', timestamp '2020-05-20 16:20:20') from dual;
  months_between  
------------------
 17.6827956989247
(1 row)

select oracle.months_between(timestamp '2022-05-15 20:20:20', timestamp '2020-01-20 19:20:20') from dual;
  months_between  
------------------
 27.8400537634409
(1 row)

select oracle.months_between(timestamp '2021-11-10 20:20:20', timestamp '2020-05-20 16:20:20') from dual;
  months_between  
------------------
 17.6827956989247
(1 row)

select oracle.months_between(timestamp '2020-11-10 20:20:20', timestamp '2025-05-20 16:20:20') from dual;
  months_between   
-------------------
 -54.3172043010753
(1 row)

select oracle.months_between(timestamptz '2021-11-10 20:20:20 +08', timestamptz '2020-05-20 16:20:20 +08') from dual;
  months_between  
------------------
 17.6827956989247
(1 row)

select oracle.months_between(timestamptz '2021-11-10 00:00:00 +08', timestamptz '2020-05-20 16:20:20 +08') from dual;
  months_between  
------------------
 17.6554584826762
(1 row)

select oracle.months_between(oracle.date '2021-11-10', timestamptz '2020-05-20 16:20:20 +08') from dual;
  months_between  
------------------
 17.6554584826762
(1 row)

select oracle.months_between(timestamptz '2020-01-10 01:00:00 +08', timestamptz '2028-05-19 16:25:20 +08') from dual;
  months_between   
-------------------
 -100.311051373955
(1 row)

select oracle.months_between(timestamptz '2021-11-10 20:20:20 +05', timestamptz '2020-05-20 16:20:20 +03') from dual;
  months_between  
------------------
 17.6801075268817
(1 row)

select oracle.months_between(timestamptz '2008-01-31 11:32:11 +8', timestamptz '2008-02-29 11:12:12') from dual;
 months_between 
----------------
             -1
(1 row)

select oracle.months_between(oracle.date '-2020-03-15', oracle.date '-2020-02-20') from dual;
  months_between   
-------------------
 0.838709677419355
(1 row)

select oracle.months_between(oracle.date '-2020-02-10', oracle.date '-2020-05-20') from dual;
  months_between   
-------------------
 -3.32258064516129
(1 row)

select oracle.months_between(oracle.date '-2021-11-10', oracle.date '-2020-05-20') from dual;
  months_between   
-------------------
 -6.32258064516129
(1 row)

select oracle.months_between(oracle.date '-2021-11-10 12:12:30', oracle.date '-2008-05-20 13:15:12') from dual;
  months_between   
-------------------
 -150.323985215054
(1 row)

--trunc function
select oracle.trunc(cast('2050-12-12' as oracle.date), 'SCC');
        trunc        
---------------------
 2001-01-01 00:00:00
(1 row)

select oracle.trunc(cast('2050-06-12' as oracle.date), 'SYYYY');
        trunc        
---------------------
 2050-01-01 00:00:00
(1 row)

select oracle.trunc(cast('2020-02-28' as oracle.date), 'IYYY');
        trunc        
---------------------
 2019-12-30 00:00:00
(1 row)

select oracle.trunc(cast('2020-02-28' as oracle.date), 'Q');
        trunc        
---------------------
 2020-01-01 00:00:00
(1 row)

select oracle.trunc(cast('2020-09-27' as oracle.date), 'MONTH');
        trunc        
---------------------
 2020-09-01 00:00:00
(1 row)

select oracle.trunc(cast('2020-03-15' as oracle.date), 'WW');
        trunc        
---------------------
 2020-03-11 00:00:00
(1 row)

select oracle.trunc(cast('2020-02-28' as oracle.date), 'IW');
        trunc        
---------------------
 2020-02-24 00:00:00
(1 row)

select oracle.trunc(cast('2020-02-23' as oracle.date), 'W');
        trunc        
---------------------
 2020-02-22 00:00:00
(1 row)

select oracle.trunc(cast('2020-06-18' as oracle.date), 'DDD');
        trunc        
---------------------
 2020-06-18 00:00:00
(1 row)

select oracle.trunc(cast('2020-02-29' as oracle.date), 'DAY');
        trunc        
---------------------
 2020-02-23 00:00:00
(1 row)

select oracle.trunc(cast('2050-12-12 12:12:13' as oracle.date), 'SCC');
        trunc        
---------------------
 2001-01-01 00:00:00
(1 row)

select oracle.trunc(cast('2050-06-12 19:00:00' as oracle.date), 'SYYYY');
        trunc        
---------------------
 2050-01-01 00:00:00
(1 row)

select oracle.trunc(cast('2020-02-28 20:00:00' as oracle.date), 'IYYY');
        trunc        
---------------------
 2019-12-30 00:00:00
(1 row)

select oracle.trunc(cast('2020-02-28 21:01:09' as oracle.date), 'Q');
        trunc        
---------------------
 2020-01-01 00:00:00
(1 row)

select oracle.trunc(cast('2020-09-27 22:10:12' as oracle.date), 'MONTH');
        trunc        
---------------------
 2020-09-01 00:00:00
(1 row)

select oracle.trunc(cast('2020-03-15 23:15:36' as oracle.date), 'WW');
        trunc        
---------------------
 2020-03-11 00:00:00
(1 row)

select oracle.trunc(cast('2020-02-28 09:11:12' as oracle.date), 'IW');
        trunc        
---------------------
 2020-02-24 00:00:00
(1 row)

select oracle.trunc(cast('2020-02-23 14:20:18' as oracle.date), 'W');
        trunc        
---------------------
 2020-02-22 00:00:00
(1 row)

select oracle.trunc(cast('2020-06-18 22:20:12' as oracle.date), 'DDD');
        trunc        
---------------------
 2020-06-18 00:00:00
(1 row)

select oracle.trunc(cast('2020-02-29 08:00:01' as oracle.date), 'DAY');
        trunc        
---------------------
 2020-02-23 00:00:00
(1 row)

select oracle.trunc(timestamp '2051-12-12 12:00:00', 'SCC');
        trunc        
---------------------
 2001-01-01 00:00:00
(1 row)

select oracle.trunc(timestamp '2050-06-12 19:20:21', 'SYYYY');
        trunc        
---------------------
 2050-01-01 00:00:00
(1 row)

select oracle.trunc(timestamp '2020-02-28 16:40:55', 'IYYY');
        trunc        
---------------------
 2019-12-30 00:00:00
(1 row)

select oracle.trunc(timestamp '2020-07-28 19:16:12', 'Q');
        trunc        
---------------------
 2020-07-01 00:00:00
(1 row)

select oracle.trunc(timestamp '2020-09-27 18:30:21', 'MONTH');
        trunc        
---------------------
 2020-09-01 00:00:00
(1 row)

select oracle.trunc(timestamp '2020-03-15 12:12:19', 'WW');
        trunc        
---------------------
 2020-03-11 00:00:00
(1 row)

select oracle.trunc(timestamp '2020-02-28 10:00:01', 'IW');
        trunc        
---------------------
 2020-02-24 00:00:00
(1 row)

select oracle.trunc(timestamp '2020-02-23 12:12:14', 'W');
        trunc        
---------------------
 2020-02-22 00:00:00
(1 row)

select oracle.trunc(timestamp '2020-06-18 13:12:18', 'DDD');
        trunc        
---------------------
 2020-06-18 00:00:00
(1 row)

select oracle.trunc(timestamp '2020-02-29 14:40:20', 'DAY');
        trunc        
---------------------
 2020-02-23 00:00:00
(1 row)

select oracle.trunc(timestamp '2020-02-29 11:40:20', 'HH');
        trunc        
---------------------
 2020-02-29 11:00:00
(1 row)

select oracle.trunc(timestamp '2020-02-29 18:40:20', 'MI');
        trunc        
---------------------
 2020-02-29 18:40:00
(1 row)

select oracle.trunc(timestamptz '2051-12-12 12:00:00 + 08', 'SCC');
         trunc          
------------------------
 2001-01-01 00:00:00+08
(1 row)

select oracle.trunc(timestamptz '2050-06-12 19:20:21 + 08', 'SYYYY');
         trunc          
------------------------
 2050-01-01 00:00:00+08
(1 row)

select oracle.trunc(timestamptz '2020-02-28 16:40:55 + 08', 'IYYY');
         trunc          
------------------------
 2019-12-30 00:00:00+08
(1 row)

select oracle.trunc(timestamptz '2020-02-28 19:16:12 + 08', 'Q');
         trunc          
------------------------
 2020-01-01 00:00:00+08
(1 row)

select oracle.trunc(timestamptz '2020-09-27 18:30:21 + 08', 'MONTH');
         trunc          
------------------------
 2020-09-01 00:00:00+08
(1 row)

select oracle.trunc(timestamptz '2020-03-15 12:12:19 + 08', 'WW');
         trunc          
------------------------
 2020-03-11 00:00:00+08
(1 row)

select oracle.trunc(timestamptz '2020-02-28 10:00:01 + 08', 'IW');
         trunc          
------------------------
 2020-02-24 00:00:00+08
(1 row)

select oracle.trunc(timestamptz '2020-02-23 12:12:14 + 08', 'W');
         trunc          
------------------------
 2020-02-22 00:00:00+08
(1 row)

select oracle.trunc(timestamptz '2020-06-18 13:12:18 + 08', 'DDD');
         trunc          
------------------------
 2020-06-18 00:00:00+08
(1 row)

select oracle.trunc(timestamptz '2020-02-29 14:40:20 + 08', 'DAY');
         trunc          
------------------------
 2020-02-23 00:00:00+08
(1 row)

select oracle.trunc(timestamptz '2020-02-29 11:40:20 + 08', 'HH');
         trunc          
------------------------
 2020-02-29 11:00:00+08
(1 row)

select oracle.trunc(timestamptz '2020-02-29 14:40:50 + 08', 'MI');
         trunc          
------------------------
 2020-02-29 14:40:00+08
(1 row)

--round function
select oracle.round(cast('2012-12-12' as oracle.date), 'CC');
        round        
---------------------
 2001-01-01 00:00:00
(1 row)

select oracle.round(cast('2051-12-12' as oracle.date), 'SCC');
        round        
---------------------
 2101-01-01 00:00:00
(1 row)

select oracle.round(cast('2050-12-12' as oracle.date), 'SYYYY');
        round        
---------------------
 2051-01-01 00:00:00
(1 row)

select oracle.round(cast('2050-06-12' as oracle.date), 'IYYY');
        round        
---------------------
 2050-01-03 00:00:00
(1 row)

select oracle.round(cast('2020-01-1'  as oracle.date), 'Q');
        round        
---------------------
 2020-01-01 00:00:00
(1 row)

select oracle.round(cast('2020-02-15' as oracle.date), 'MONTH');
        round        
---------------------
 2020-02-01 00:00:00
(1 row)

select oracle.round(cast('2020-02-29' as oracle.date), 'WW');
        round        
---------------------
 2020-02-26 00:00:00
(1 row)

select oracle.round(cast('2020-03-15' as oracle.date), 'IW');
        round        
---------------------
 2020-03-16 00:00:00
(1 row)

select oracle.round(cast('2020-02-28' as oracle.date), 'W');
        round        
---------------------
 2020-02-29 00:00:00
(1 row)

select oracle.round(cast('2020-03-15' as oracle.date), 'DDD');
        round        
---------------------
 2020-03-15 00:00:00
(1 row)

select oracle.round(cast('2020-06-18' as oracle.date), 'DAY');
        round        
---------------------
 2020-06-21 00:00:00
(1 row)

select oracle.round(cast('2012-12-12 12:13:15' as oracle.date), 'CC');
        round        
---------------------
 2001-01-01 00:00:00
(1 row)

select oracle.round(cast('2051-12-12 19:00:00' as oracle.date), 'SCC');
        round        
---------------------
 2101-01-01 00:00:00
(1 row)

select oracle.round(cast('2050-12-12 20:00:00' as oracle.date), 'SYYYY');
        round        
---------------------
 2051-01-01 00:00:00
(1 row)

select oracle.round(cast('2050-06-12 21:40:00' as oracle.date), 'IYYY');
        round        
---------------------
 2050-01-03 00:00:00
(1 row)

select oracle.round(cast('2020-01-1 22:00:00'  as oracle.date), 'Q');
        round        
---------------------
 2020-01-01 00:00:00
(1 row)

select oracle.round(cast('2020-02-15 23:57:09' as oracle.date), 'MONTH');
        round        
---------------------
 2020-02-01 00:00:00
(1 row)

select oracle.round(cast('2020-02-29 11:11:00' as oracle.date), 'WW');
        round        
---------------------
 2020-02-26 00:00:00
(1 row)

select oracle.round(cast('2020-03-15 09:05:21' as oracle.date), 'IW');
        round        
---------------------
 2020-03-16 00:00:00
(1 row)

select oracle.round(cast('2020-02-28 21:11:01' as oracle.date), 'W');
        round        
---------------------
 2020-02-29 00:00:00
(1 row)

select oracle.round(cast('2020-03-15 13:04:21' as oracle.date), 'DDD');
        round        
---------------------
 2020-03-16 00:00:00
(1 row)

select oracle.round(cast('2020-06-18 22:03:01' as oracle.date), 'DAY');
        round        
---------------------
 2020-06-21 00:00:00
(1 row)

select oracle.round(timestamp '2012-12-12 12:00:00', 'CC');
        round        
---------------------
 2001-01-01 00:00:00
(1 row)

select oracle.round(timestamp '2050-12-12 12:00:00', 'SCC');
        round        
---------------------
 2001-01-01 00:00:00
(1 row)

select oracle.round(timestamp '2050-06-12 19:20:21', 'SYYYY');
        round        
---------------------
 2050-01-01 00:00:00
(1 row)

select oracle.round(timestamp '2050-06-12 16:40:55', 'IYYY');
        round        
---------------------
 2050-01-03 00:00:00
(1 row)

select oracle.round(timestamp '2020-02-16 19:16:12', 'Q');
        round        
---------------------
 2020-04-01 00:00:00
(1 row)

select oracle.round(timestamp '2020-09-27 18:30:21', 'MONTH');
        round        
---------------------
 2020-10-01 00:00:00
(1 row)

select oracle.round(timestamp '2020-03-15 12:12:19', 'WW');
        round        
---------------------
 2020-03-18 00:00:00
(1 row)

select oracle.round(timestamp '2020-02-28 10:00:01', 'IW');
        round        
---------------------
 2020-03-02 00:00:00
(1 row)

select oracle.round(timestamp '2020-02-23 12:12:14', 'W');
        round        
---------------------
 2020-02-22 00:00:00
(1 row)

select oracle.round(timestamp '2020-06-18 13:12:18', 'DDD');
        round        
---------------------
 2020-06-19 00:00:00
(1 row)

select oracle.round(timestamp '2020-02-29 14:40:20', 'DAY');
        round        
---------------------
 2020-03-01 00:00:00
(1 row)

select oracle.round(timestamp '2020-02-29 11:40:20', 'HH');
        round        
---------------------
 2020-02-29 12:00:00
(1 row)

select oracle.round(timestamp '2020-02-29 14:40:20', 'MI');
        round        
---------------------
 2020-02-29 14:40:00
(1 row)

select oracle.round(timestamptz '2012-12-12 12:00:00 + 08', 'CC');
         round          
------------------------
 2001-01-01 00:00:00+08
(1 row)

select oracle.round(timestamptz '2050-12-12 12:00:00 + 08', 'SCC');
         round          
------------------------
 2001-01-01 00:00:00+08
(1 row)

select oracle.round(timestamptz '2051-12-12 12:00:00 + 08', 'SCC');
         round          
------------------------
 2101-01-01 00:00:00+08
(1 row)

select oracle.round(timestamptz '2050-06-12 19:20:21 + 08', 'SYYYY');
         round          
------------------------
 2050-01-01 00:00:00+08
(1 row)

select oracle.round(timestamptz '2050-06-12 16:40:55 + 08', 'IYYY');
         round          
------------------------
 2050-01-03 00:00:00+08
(1 row)

select oracle.round(timestamptz '2020-02-16 19:16:12 + 08', 'Q');
         round          
------------------------
 2020-04-01 00:00:00+08
(1 row)

select oracle.round(timestamptz '2020-09-27 18:30:21 + 08', 'MONTH');
         round          
------------------------
 2020-10-01 00:00:00+08
(1 row)

select oracle.round(timestamptz '2020-03-15 12:12:19 + 08', 'WW');
         round          
------------------------
 2020-03-18 00:00:00+08
(1 row)

select oracle.round(timestamptz '2020-02-28 10:00:01 + 08', 'IW');
         round          
------------------------
 2020-03-02 00:00:00+08
(1 row)

select oracle.round(timestamptz '2020-02-23 12:12:14 + 08', 'W');
         round          
------------------------
 2020-02-22 00:00:00+08
(1 row)

select oracle.round(timestamptz '2020-06-18 13:12:18 + 08', 'DDD');
         round          
------------------------
 2020-06-19 00:00:00+08
(1 row)

select oracle.round(timestamptz '2020-02-29 14:40:20 + 08', 'DAY');
         round          
------------------------
 2020-03-01 00:00:00+08
(1 row)

select oracle.round(timestamptz '2020-02-29 11:40:20 + 08', 'HH');
         round          
------------------------
 2020-02-29 12:00:00+08
(1 row)

select oracle.round(timestamptz '2020-06-18 14:40:20 + 08', 'MI');
         round          
------------------------
 2020-06-18 14:40:00+08
(1 row)

--next_day function
select oracle.next_day(date '2020-02-15', 'Monday') from dual;
      next_day       
---------------------
 2020-02-17 00:00:00
(1 row)

select oracle.next_day(date '2020-02-29', 'Monday') from dual;
      next_day       
---------------------
 2020-03-02 00:00:00
(1 row)

select oracle.next_day(date '2020-06-14', 'Wednesday') from dual;
      next_day       
---------------------
 2020-06-17 00:00:00
(1 row)

select oracle.next_day(date '2020-07-20', 'Wednesday') from dual;
      next_day       
---------------------
 2020-07-22 00:00:00
(1 row)

select oracle.next_day(date '2020-09-15', 'Friday') from dual;
      next_day       
---------------------
 2020-09-18 00:00:00
(1 row)

select oracle.next_day(date '2020-09-22', 'Friday') from dual;
      next_day       
---------------------
 2020-09-25 00:00:00
(1 row)

select oracle.next_day(date '2020-02-15', 2) from dual;
      next_day       
---------------------
 2020-02-17 00:00:00
(1 row)

select oracle.next_day(date '2020-02-29', 2) from dual;
      next_day       
---------------------
 2020-03-02 00:00:00
(1 row)

select oracle.next_day(date '2020-06-14', 4) from dual;
      next_day       
---------------------
 2020-06-17 00:00:00
(1 row)

select oracle.next_day(date '2020-07-20', 4) from dual;
      next_day       
---------------------
 2020-07-22 00:00:00
(1 row)

select oracle.next_day(date '2020-09-15', 6) from dual;
      next_day       
---------------------
 2020-09-18 00:00:00
(1 row)

select oracle.next_day(date '2020-09-22', 6) from dual;
      next_day       
---------------------
 2020-09-25 00:00:00
(1 row)

select oracle.next_day(oracle.date '2020-02-15 12:10:10', 2) from dual;
      next_day       
---------------------
 2020-02-17 12:10:10
(1 row)

select oracle.next_day(oracle.date '2020-02-29 09:45:59', 3) from dual;
      next_day       
---------------------
 2020-03-03 09:45:59
(1 row)

select oracle.next_day(oracle.date '2020-06-14 01:20:12', 4) from dual;
      next_day       
---------------------
 2020-06-17 01:20:12
(1 row)

select oracle.next_day(oracle.date '2020-07-20 14:20:23', 5) from dual;
      next_day       
---------------------
 2020-07-23 14:20:23
(1 row)

select oracle.next_day(oracle.date '2020-09-15 05:19:43', 6) from dual;
      next_day       
---------------------
 2020-09-18 05:19:43
(1 row)

select oracle.next_day(oracle.date '2020-09-22 12:00:00', 7) from dual;
      next_day       
---------------------
 2020-09-26 12:00:00
(1 row)

select oracle.next_day(to_timestamp('2020-02-29 14:40:50', 'YYYY-MM-DD HH24:MI:SS'), 'Tuesday') from dual;
      next_day       
---------------------
 2020-03-03 14:40:50
(1 row)

select oracle.next_day(to_timestamp('2020-05-05 19:43:51', 'YYYY-MM-DD HH24:MI:SS'), 'thursday') from dual;
      next_day       
---------------------
 2020-05-07 19:43:51
(1 row)

select oracle.next_day(to_timestamp('2020-06-22 19:43:51', 'YYYY-MM-DD HH24:MI:SS'), 'Saturday') from dual;
      next_day       
---------------------
 2020-06-27 19:43:51
(1 row)

select oracle.next_day(to_timestamp('2020-07-01 19:43:51', 'YYYY-MM-DD HH24:MI:SS'), 'Sunday') from dual;
      next_day       
---------------------
 2020-07-05 19:43:51
(1 row)

select oracle.next_day(to_timestamp('2020-02-29 14:40:50', 'YYYY-MM-DD HH24:MI:SS'), 3) from dual;
      next_day       
---------------------
 2020-03-03 14:40:50
(1 row)

select oracle.next_day(to_timestamp('2020-05-05 19:43:51', 'YYYY-MM-DD HH24:MI:SS'), 5) from dual;
      next_day       
---------------------
 2020-05-07 19:43:51
(1 row)

select oracle.next_day(to_timestamp('2020-06-22 19:43:51', 'YYYY-MM-DD HH24:MI:SS'), 7) from dual;
      next_day       
---------------------
 2020-06-27 19:43:51
(1 row)

select oracle.next_day(to_timestamp('2020-07-01 19:43:51', 'YYYY-MM-DD HH24:MI:SS'), 1) from dual;
      next_day       
---------------------
 2020-07-05 19:43:51
(1 row)

select oracle.next_day('2020-02-29 14:40:50'::timestamptz, 'Tuesday') from dual;
      next_day       
---------------------
 2020-03-03 14:40:50
(1 row)

select oracle.next_day('2020-05-05 19:43:51'::timestamptz, 'thursday') from dual;
      next_day       
---------------------
 2020-05-07 19:43:51
(1 row)

select oracle.next_day('2020-06-22 19:43:51'::timestamptz, 'Saturday') from dual;
      next_day       
---------------------
 2020-06-27 19:43:51
(1 row)

select oracle.next_day('2020-07-01 19:43:51'::timestamptz, 'Sunday') from dual;
      next_day       
---------------------
 2020-07-05 19:43:51
(1 row)

select oracle.next_day('2020-02-29 14:40:50'::timestamptz, 3) from dual;
      next_day       
---------------------
 2020-03-03 14:40:50
(1 row)

select oracle.next_day('2020-05-05 19:43:51'::timestamptz, 5) from dual;
      next_day       
---------------------
 2020-05-07 19:43:51
(1 row)

select oracle.next_day('2020-06-22 19:43:51'::timestamptz, 7) from dual;
      next_day       
---------------------
 2020-06-27 19:43:51
(1 row)

select oracle.next_day('2020-07-01 19:43:51'::timestamptz, 1) from dual;
      next_day       
---------------------
 2020-07-05 19:43:51
(1 row)

--last_day function
select oracle.last_day(date '2020-02-15');
      last_day       
---------------------
 2020-02-29 00:00:00
(1 row)

select oracle.last_day(date '2020-07-11');
      last_day       
---------------------
 2020-07-31 00:00:00
(1 row)

select oracle.last_day(date '2020-09-09');
      last_day       
---------------------
 2020-09-30 00:00:00
(1 row)

select oracle.last_day(date '2020-02-15');
      last_day       
---------------------
 2020-02-29 00:00:00
(1 row)

select oracle.last_day(date '2020-07-11');
      last_day       
---------------------
 2020-07-31 00:00:00
(1 row)

select oracle.last_day(date '2020-09-09');
      last_day       
---------------------
 2020-09-30 00:00:00
(1 row)

select oracle.last_day(date '2020-02-15');
      last_day       
---------------------
 2020-02-29 00:00:00
(1 row)

select oracle.last_day(date '2020-11-11');
      last_day       
---------------------
 2020-11-30 00:00:00
(1 row)

select oracle.last_day(date '2020-09-09');
      last_day       
---------------------
 2020-09-30 00:00:00
(1 row)

select oracle.last_day('2020-02-12 12:45:12'::timestamp) from dual;
      last_day       
---------------------
 2020-02-29 12:45:12
(1 row)

select oracle.last_day(timestamp '2020-05-17 13:27:19') from dual;
      last_day       
---------------------
 2020-05-31 13:27:19
(1 row)

select oracle.last_day(timestamp '2020-08-21 19:20:40') from dual;
      last_day       
---------------------
 2020-08-31 19:20:40
(1 row)

select oracle.last_day('2020-10-05 12:45:12 +08'::timestamptz) from dual;
      last_day       
---------------------
 2020-10-31 12:45:12
(1 row)

select oracle.last_day('2020-12-17 13:27:19 +08'::timestamptz) from dual;
      last_day       
---------------------
 2020-12-31 13:27:19
(1 row)

select oracle.last_day('2020-11-29 19:20:40 +08'::timestamptz) from dual;
      last_day       
---------------------
 2020-11-30 19:20:40
(1 row)

select oracle.last_day('-0001-3-1 13:27:19'::oracle.date) from dual;
       last_day       
----------------------
 -0001-03-31 13:27:19
(1 row)

select oracle.last_day('-0001-4-1 13:27:19'::oracle.date) from dual;
       last_day       
----------------------
 -0001-04-30 13:27:19
(1 row)

select oracle.last_day('-0001-2-1 13:27:19'::oracle.date) from dual;
       last_day       
----------------------
 -0001-02-28 13:27:19
(1 row)

select oracle.last_day('-0004-2-1 13:27:19'::oracle.date) from dual;
       last_day       
----------------------
 -0004-02-29 13:27:19
(1 row)

select oracle.last_day(oracle.date '2021-01-15 14:20:23');
      last_day       
---------------------
 2021-01-31 14:20:23
(1 row)

select oracle.last_day(oracle.date '2021-02-11 09:10:21');
      last_day       
---------------------
 2021-02-28 09:10:21
(1 row)

select oracle.last_day(oracle.date '2021-03-09 12:33:11');
      last_day       
---------------------
 2021-03-31 12:33:11
(1 row)

select oracle.last_day(oracle.date '2021-04-15 11:59:59');
      last_day       
---------------------
 2021-04-30 11:59:59
(1 row)

select oracle.last_day(oracle.date '2021-05-01 12:10:01');
      last_day       
---------------------
 2021-05-31 12:10:01
(1 row)

select oracle.last_day(oracle.date '2021-06-18 01:00:01');
      last_day       
---------------------
 2021-06-30 01:00:01
(1 row)

select oracle.last_day(oracle.date '2021-07-07 05:20:18');
      last_day       
---------------------
 2021-07-31 05:20:18
(1 row)

select oracle.last_day(oracle.date '2021-08-15 17:19:13');
      last_day       
---------------------
 2021-08-31 17:19:13
(1 row)

select oracle.last_day(oracle.date '2021-09-15 16:19:10');
      last_day       
---------------------
 2021-09-30 16:19:10
(1 row)

select oracle.last_day(oracle.date '2021-11-11 17:30:00');
      last_day       
---------------------
 2021-11-30 17:30:00
(1 row)

select oracle.last_day(oracle.date '2021-12-09 22:00:00');
      last_day       
---------------------
 2021-12-31 22:00:00
(1 row)

