-- create databases
create database gbk_copy encoding='gbk' LC_COLLATE='C' LC_CTYPE ='C' TEMPLATE=template0;
create database gb18030_copy encoding='gb18030' LC_COLLATE='C' LC_CTYPE ='C' TEMPLATE=template0;
----------------------------------------------
-- GB18030 Copy Test
\c gb18030_copy
load 'gb18030_2022';
show server_encoding;
 server_encoding 
-----------------
 GB18030
(1 row)

set client_encoding to utf8;
show client_encoding;
 client_encoding 
-----------------
 UTF8
(1 row)

-- 1. copy from text
create table copy_18030_test(x text);
copy copy_18030_test from STDIN;
select * from copy_18030_test;
                x                 
----------------------------------
 狜狝狟狢狣狤狥狦狧狪狫狵狶狹狽狾
 狿猀猂猄猅猆猇猈猉猋猌猍猏猐猑猒
 猔猘猙猚猟猠猣猤猦猧猨猭猯猰猲猳
 猵猶猺猻猼猽獀獁獂獃獄獅獆獇獈
 獉獊獋獌獎獏獑獓獔獕獖獘獙獚獛獜
 獝獞獟獡獢獣獤獥獦獧獨獩獪獫獮獰
 獱
(7 rows)

drop table copy_18030_test;
-- 2. copy from csv
create table copy_csv_18030(x text,y text);
copy copy_csv_18030 from STDIN CSV DELIMITER '@' ESCAPE 'g' QUOTE '/';
select * from copy_csv_18030;
                     x                     |                 y                 
-------------------------------------------+-----------------------------------
 狜狝狟狢gdasgds狣㐴㐵㐶㐷㐸㐹㐺㐻㐼狤狥狦 | 狧狪狫狵㒰㒱㒲㒳㒴狶狹狽狾
 狿猀猂猄猅㓢㓣㓤㓥㓦猆gdsgdsag猇猈        | 猉猋猌猍gfsaf㓿㔀㔁㔂㔃sa猏猐猑猒
 猔猘猙猚gdsgrds猟gfdsagds猠gdsgds猣猤     | 猦猧猨gds猭猯猰猲猳
 猵猶猺猻猼猽獀獁                          | 獂獃獄獅獆獇獈　
 獉獊獋獌獎獏獑獓                          | gdsgras
 獝獞獟獡獢獣gda獤獥                       | 獦獧獨獩gdsgds獪獫獮獰
 gdaggds獱                                 | 1fasfs
(7 rows)

drop table copy_csv_18030;
------------------------------------------
-- GBK Copy Test
\c gbk_copy
load 'gb18030_2022';
show server_encoding;
 server_encoding 
-----------------
 GBK
(1 row)

set client_encoding to utf8;
show client_encoding;
 client_encoding 
-----------------
 UTF8
(1 row)

-- 1. copy from text
create table copy_gbk_test(x text);
copy copy_gbk_test from STDIN;
select * from copy_gbk_test;
                x                 
----------------------------------
 狜狝狟狢狣狤狥狦狧狪狫狵狶狹狽狾
 狿猀猂猄猅猆猇猈猉猋猌猍猏猐猑猒
 猔猘猙猚猟猠猣猤猦猧猨猭猯猰猲猳
 猵猶猺猻猼猽獀獁獂獃獄獅獆獇獈
 獉獊獋獌獎獏獑獓獔獕獖獘獙獚獛獜
 獝獞獟獡獢獣獤獥獦獧獨獩獪獫獮獰
 獱
(7 rows)

drop table copy_gbk_test;
-- 2. copy from csv
create table copy_csv_gbk(x text,y text);
copy copy_csv_gbk from STDIN CSV DELIMITER '@' ESCAPE 'g' QUOTE '/';
select * from copy_csv_gbk;
      x       |        y         
--------------+------------------
 狜狝狟狢狣猣 | 獎獏獑獓gl猇猈猉
 copy test g\ | 獎獏獑獓獔獕獖
(2 rows)

drop table copy_csv_gbk;
\c postgres
drop database gbk_copy;
drop database gb18030_copy;
